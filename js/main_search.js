const sections = {
  intro: {
    title: "project introduction",
    detail: `<h4 id="x_">We propose the first stage of a program of research aiming to improve the training of Learning Assistants (LA), which are composed of graduate teaching assistants and undergraduate learning assistants, in the context of inquiry-based introductory physics classes. In stage one, which consists of three phases, we will design and validate an instrument to measure LAs’ Pedagogical Content Knowledge of questioning (PCK-Q) and then develop hierarchical linear models (HLM) to comprehensively describe the influence of LAs’ PCK-Q on college students’ conceptual understanding of physics and critical thinking skills. The project will also yield qualitative data suggesting effective strategies for LA training and LA-student interaction in an inquiry-oriented setting. </h4>
    <h4 id="x_">In the first phase, we will examine LAs’ questions that stimulate active interaction or productive learning of students. In the first phase, we will capture videos of LAs interacting with students during classes of classic mechanics and electromagnetism. From the videos, we will identify scenarios where LAs either manage or fail to initiate active responses from students with questions, such as those expose student misconception or prompt ideas about lab design. Then we will convert some scenarios into open-ended questions as the first version of the PCK-Q test. In the second phase, we will administer PCK-Q Version 1 validated from Phase 1 with LAs and use their answers to develop options with which we will transform the open-ended into multiple-choice questions. The validated multiple-choice questions comprise the second version of the PCK-Q test. The process of developing and validating both versions of the PCK-Q test will also yield qualitative data that contribute to the assessment and adjustment of SA training strategies. In the third phase, we will use PCK-Q Version 2 to measure SAs’ PCK-Q and build HLMs how SAs’ PCK-Q account for college students’ conceptual understanding of introductory physics and critical thinking skills.</h4>  
    <h4 id="x_">Reform in the teaching of college-level introductory physics has promoted a shift from lecturing and factual recitation to interactive learning and conceptual understanding, as embodied in the “inquiry method.” Increasing enrollment in physics (and other STEM) classes requires the services of large numbers of LAs. There is some evidence that LA programs promote student learning, but no understanding of the mechanism of this connection. It is assumed that LA programs aid in improving student thinking, but we lack evidence to support this assumption, or any determination of how this transfer occurs. We believe that LAs knowledge of PCK-Q is at the heart of what makes for successful LA support. Specifically, we hypothesize that LAs’ sophisticated levels of PCK-Q will enable them to improve their abilities to prompt student thinking and scaffold group interaction in inquiry-based classrooms. PCK and the training of SA are not new concepts. What is innovative about our approach is 1) developing both the open-ended and multiple-choice versions of an instrument that can validly and reliably assess SAs’ PCK-Q; and 2) building hierarchical linear models that contribute to a comprehensive understanding of the role of SAs’ PCK-Q in college students’ physics learning. Our proposed study will benefit the field of undergraduate physics instruction by adding new insights into how SAs may best serve student learning in introductory physics classrooms. Long-term benefits include increased efficiency and lower costs of physics education, and adaptions for use in other STEM fields.</h4>
    <h4 id="x_">The proposed research will initially benefit physics instruction at Texas Tech University. The products from this research will be made available to physics instructors across the country, and the instrument can be modified for use in other STEM disciplines. A common strategy in universities nationwide is to decrease costs by using LAs to assist in providing STEM instruction. By monitoring the quality of LAs through our PCK-Q instrument, we have the potential to better prepare LAs to act as instructional leads in inquiry-based classrooms and enhance college-level physics and other STEM education throughout the United States.</h4>`,
  },
  video: {
    title: "demo videos",
    details: [
      {
        url: "https://www.youtube.com/embed/yD9AO4PzE_0",
        desc: "",
      },
    ],
  },
  team: {
    title: "research team",
    people: [
      {
        name: "Jianlan Wang",
        position: "Principal Investigator",
        photo: "assets/mock_demo/jay.png",
        bio:
          "Dr. Wang is an assistant professor in the Department of Teacher Education at Texas Tech University. Dr. Wang has rich experience in designing, implementing, and researching inquiry-based and argumentation-leveraged science units from K to 8 and physics units from 9 to college. He has taught inquiry-oriented physics courses in both high school (AP physics) and college (introductory calculus-based physics). His work also involves reforming instructional methods courses for elementary and secondary science teacher candidates through the constructivist approach. Dr. Wang is skilled in both qualitative and quantitative research methods. His research foci at Texas Tech University include designing and evaluating a scaffolding approach to the knowledge construction of teacher candidates and building models of different kinds (e.g. hierarchical linear model) that connect the variables of educational reforms, teacher knowledge, teacher practice, and student performance.",
      },
      {
        name: "Beth Thacker",
        position: "Co-Principal Investigator",
        photo: "assets/mock_demo/Thacker.png",
        bio:
          "Dr. Thacker is an Associate Professor of Physics. She has most recently been working on course and curriculum development and assessment. She has developed a laboratory-based, inquiry-based curriculum (INQ) taught using Socratic questioning pedagogy and has done significant work investigating students’ qualitative and quantitative understanding of physics concepts in courses taught by traditional and non-traditional methods. She is presently working on the expansion of the INQ course to a larger classroom, including training of student assistants (SAs), and research on SA’s pedagogical content knowledge of questioning (PCK-Q), as well as a study of the thinking skills of INQ students. She is also researching the effectiveness of Augmented Reality (AR) on increasing students understanding of magnetism through 3-D visualization of magnetic fields enhanced by a 3-D AR interactive simulation. In addition, she has studied students understanding of topics in modern physics and quantum mechanics and has a recent interest in quantum computing.",
      },
      {
        name: "Stephanie Hart",
        position: "Co-Principal Investigator",
        photo: "assets/mock_demo/Hart.png",
        bio:
          "Dr. Hart is the Director of the TTU OnRamps program, a dual enrollment initiative that gives high school students the opportunity to earn college credits in STEM courses. The OnRamps program trains teachers to implement inquiry-based instruction, peer instruction, and student-centered learning with college content in a high school classroom. Her background is in behavioral science and teacher education. Dr. Hart specializes in coaching college instructors and K-12 teachers in pedagogy, observational assessment, educational measurement, and data-based instruction. She is a Board Certified Behavior Analyst-Doctoral Level (BCBA-D). She is also on the graduate faculty in the College of Education at Texas Tech and teaches master’s level courses in Applied Behavior Analysis.",
      },
      {
        name: "Kyle Wipfli",
        position: "Graduate Research Assistant",
        photo: "assets/mock_demo/Kyle.png",
        bio:
          "Kyle is a graduate student in the College of Arts and Sciences at Texas Tech University working on a PhD in Physics focusing on Physics Education Research. He graduated from the University of Tulsa earning a B.S. in Physics and a B.A. in Chinese Studies in 2018. He is interested in methodologies used in the physics classroom and how it can apply to graduate and upper-level undergraduate courses.",
      },
    ],
  },
  sponsor: {
    title: "sponsors",
    sponsors: [
      {
        name: "",
        logo: "assets/mock_demo/nsf-with-detail.png",
        url: "https://www.nsf.gov/",
      },
      {
        name: "",
        logo: "assets/mock_demo/TTU_DblT_CoE_c4C.png",
        url: "https://www.depts.ttu.edu/education/",
      },
    ],
  },
  location: {
    title: "location",
    address: "Texas Tech University 2500 Broadway Lubbock, Texas 79409",
  },
};

const pageContent = {
  pages: [
    {
      title: "SAMPLE PCK-Q QUESTIONS",
      url: "https://www.pck-q-ttu.com/pckq.html",
      detail:
        "Preliminary open-ended PCK-Q questionSAMPLE PCK-Q QUESTIONS PCK-CM-1Context: Students are conducting a lab about free falling. They are required to use a motion detector to draw position vs. time (s-t),velocity vs. time (v-t), and acceleration vs. time (a-t) graphs of the free falling of three different objects, a book, a small basketball, and a box. The motion detector is held above the objects, facing downward. Moving away from the detector is recorded as the positive direction. She wants to check whether the students understand the relationship between s-t, v-t, and a-t graphs. Below is the conversation she has with themSA: What does the position graph tell you?S: It hit the ground and stopped.SA: OK. Does the velocity graph match the position graph?S: Yes, because it increasesSA: OK. Does the acceleration graph match the velocity graph?S: Yes. If you are increasing at a constant rate, you cannot accelerate. Right?a) What conclusion can you draw about the student’s knowledge based on the information provided above?b) What may be the student’s difficulties? What support or help do you think the student needs from the SA?c) How should the SA respond to the student? Why?",
    },
  ],
};

function findArrayMatches(wordToMatch, arr, section) {
  const regex = new RegExp(wordToMatch, "gi");
  const matchedArray = arr.filter((item) => {
    switch (section) {
      case "video":
        return item.desc.match(regex);
      case "team":
        return (
          item.name.match(regex) ||
          item.position.match(regex) ||
          item.bio.match(regex)
        );
      case "sponsor":
        return item.name.match(regex);
    }
  });

  if (matchedArray.length == 0) {
    return null;
  }

  const html = matchedArray.map((item) => {
    switch (section) {
      case "video":
        return {
          url: item.urel,
          desc: item.desc.replace(
            regex,
            `<span class="hl">${wordToMatch}</span>`
          ),
        };
      case "team":
        return {
          name: item.name.replace(
            regex,
            `<span class="hl">${wordToMatch}</span>`
          ),
          position: item.position.replace(
            regex,
            `<span class="hl">${wordToMatch}</span>`
          ),
          bio: item.bio.replace(
            regex,
            `<span class="hl">${wordToMatch}</span>`
          ),
          photo: item.photo,
        };
      case "sponsor":
        return {
          name: item.name.replace(
            regex,
            `<span class="hl">${wordToMatch}</span>`
          ),
          logo: item.logo,
          url: item.url,
        };
    }
  });

  return html;
}

function findStringMatches(wordToMatch, str) {
  const regex = new RegExp(wordToMatch, "gi");
  const matched = str.match(regex);
  let searchResult;
  if (matched && matched[0] != "") {
    searchResult = str.replace(regex, `<span class="hl">${wordToMatch}</span>`);
  }

  return searchResult;
}

function displayMatches(e) {
  if (e.which === 13 || e.key == "Enter" || e.code == "Enter") {
    e.preventDefault();
    return false;
  }

  console.log("SEARCG: ", this.value);
  if (this.value == "") {
    showList();
    return;
  }

  const introTitle = findStringMatches(this.value, sections.intro.title);
  const introDetail = findStringMatches(this.value, sections.intro.detail);
  const intro =
    introTitle || introDetail
      ? renderIntro({
          title: introTitle ? introTitle : sections.intro.title,
          detail: introDetail ? introDetail : sections.intro.detail,
        })
      : "";

  const videoTitle = findStringMatches(this.value, sections.video.title);
  const videoList = findArrayMatches(
    this.value,
    sections.video.details,
    "video"
  );
  const video =
    videoTitle || videoList
      ? renderVideo({
          title: videoTitle ? videoTitle : sections.video.title,
          details: videoList ? videoList : sections.video.details,
        })
      : "";

  const teamTitle = findStringMatches(this.value, sections.team.title);
  const teamList = findArrayMatches(this.value, sections.team.people, "team");
  const team =
    teamTitle || teamList
      ? renderTeam({
          title: teamTitle ? teamTitle : sections.team.title,
          people: teamList ? teamList : sections.team.people,
        })
      : "";

  const sponsorTitle = findStringMatches(this.value, sections.sponsor.title);
  const sponsorList = findArrayMatches(
    this.value,
    sections.sponsor.sponsors,
    "sponsor"
  );
  const sponsor =
    sponsorTitle || sponsorList
      ? renderSponsor({
          title: sponsorTitle ? sponsorTitle : sections.sponsor.title,
          sponsors: sponsorList ? sponsorList : sections.sponsor.sponsors,
        })
      : "";

  const locationTitle = findStringMatches(this.value, sections.location.title);
  const locationAddress = findStringMatches(
    this.value,
    sections.location.address
  );
  const location =
    locationTitle || locationAddress
      ? renderIntro({
          title: locationTitle ? locationTitle : sections.location.title,
          detail: locationAddress ? locationAddress : sections.location.address,
        })
      : "";

  const pckPageDetail = pageContent.pages.filter((page) => {
    if (page.title === "SAMPLE PCK-Q QUESTIONS") {
      return page.detail;
    }
  });
  const pckQuestion = findStringMatches(this.value, pckPageDetail[0].detail);

  const pckqPage = pckQuestion ? renderPage(pckPageDetail[0]) : "";

  const page = intro + video + team + sponsor + location + pckqPage;
  if (page != "") {
    contentPage.innerHTML = page;
  } else {
    contentPage.innerHTML = `<h3 style="
                                  position: relative;
                                  margin: 30px auto;
                                  text-align: center;
                              ">Your Search Did Not Match Any Documents</h3>`;
  }
}

function renderIntro(intro) {
  return `<div id="about" class="container-fluid max-width">
            <div class="row">
                <div class="col-sm-12">
                    <h2 class="about-school">${intro.title}</h2><br>
                    <h4 class="about-school-detail" style="text-align: justify;text-indent: 80px;">${intro.detail}</h4>
                </div>
            </div>
          </div>`;
}

function renderVideo(video) {
  const title = `<h2 class="about-school text-center">${video.title}</h2><br>`;
  const videos = video.details
    .map((item) => {
      return `<div class="row">
            <div id="overlay" class="video-container">
              <div class="overlay-pwd stack-top" id="overlay-pwd" hidden>
                <div class="overlay-pwd-protected-name">PCK-Q</div>
                <div class="overlay-pwd-protected-wrap">
                  <div class="overlay-pwd-protected-text">
                    Password Required
                  </div>
                  <div class="overlay-pwd-form">
                    <input
                      class="text-form"
                      type="password"
                      placeholder="  Password"
                      id="pwd"
                      minlength="8"
                    />
                    <input
                      class="submit-btn"
                      type="button"
                      value="Watch Video"
                      onclick="checkPassword(this)"
                    />
                  </div>
                </div>
              </div>

              <div class="overlay-video">
                <iframe
                  id="video"
                  src=${item.url}
                  frameborder="0"
                  allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                  allowfullscreen
                ></iframe>
              </div>
            </div>
            <div style="
                width: 640px;
                position: relative;
                margin: 0 auto;
            ">
            <div style="
                font-size: 20px;
                font-weight: bold;
                margin-top: 10px;
            " hidden>Description</div>
            <span style="
              display: inline-block;
              text-align: justify;
              font-size: 16px;
              text-indent: 
              30px;margin-top: 10px;"
              >${item.desc}</span>
            </div>         
          </div>
          <br />`;
    })
    .join("");

  return `<div id="demo" class="container-fluid text-center max-width">
              <div class="container-fluid max-width">
                  <div class="row">
                      <div class="col-sm-12">
                          ${title}
                          ${videos}
                        </div>
                      </div>
                    </div>
                  </div>`;
}

function renderTeam(team) {
  const title = `<div class="row">
                    <div class="col-sm-12">
                        <h2 class="speakers-text">${team.title}</h2><br></div>
                  </div>`;
  const peoppleList = team.people
    .map((item) => {
      return `<div class="col-sm-6">
              <div class="speaker"> <img class="thumbnail-circle" src=${item.photo} alt="">
                  <h3>${item.name}</h3>
                  <h4>${item.position}</h4>
                  <h5>${item.bio}</h5>
              </div>
          </div>`;
    })
    .join("");

  return `<div id="speakers" class="container-fluid text-center max-width">
            ${title}
            <div class="row slideanim speaker-list">
            ${peoppleList}
            </div>
          </div>`;
}

function renderSponsor(sponsor) {
  const title = `<div class="text-center"><h2 class="sponsors">${sponsor.title}</h2></div>`;
  const sponsorList = sponsor.sponsors
    .map((item) => {
      return `<div class="col-sm-6">
                <div class="sponsor-logo">
                  <a href=${item.url} target="_blank">
                  <img src=${item.logo} alt=${item.name}> 
                  </a>
                  <h4>${item.name}</h4>
                </div>
              </div>`;
    })
    .join("");

  return `<div id="sponsors-organizers" class="container-fluid text-center max-width">
            ${title}
            <div class="row text-center slideanim">
            ${sponsorList}
            </div>
          </div>`;
}

function renderMap(map) {
  const mapTitle = `<h2 class="location-school">${map.title}</h2>`;
  const address = `<h4 class="location-school-info">${map.address}<br></h4>`;
  return `<div id="location" class="container-fluid text-center max-width">
            <div class="row">
                <div class="col-sm-12">
                    ${mapTitle}
                    ${address}
                </div>
            </div>
            <div class="row">
                <div class="col-sm-12 location-container">
                    <iframe width="100%" height="100%" frameborder="0" style="border: 0" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d830.9527108602603!2d-101.87882937080325!3d33.58426021603459!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8640c413f31ec847%3A0x52db374b7b07849!2sTexas%20Tech%20University!5e0!3m2!1sen!2sus!4v1583752690421!5m2!1sen!2sus"
                        allowfullscreen></iframe>
                </div>
            </div>
          </div>`;
}

function renderPage(page) {
  return `<div id="about" class="container-fluid max-width">
            <div class="row">
              <div class="col-sm-12">
                <h4 style="
                  position: relative;
                  margin: 30px auto;
                  text-align: center;
              ">Found in <a href=${page.url} target="_blank">${page.title}</a> page
              </h4>  
              <iframe src=${page.url} style="height:800px;width:100%;"></iframe>  
              </div>
              </div>
          </div>`;
}

function showList() {
  const intro = renderIntro(sections.intro);
  const video = renderVideo(sections.video);
  const team = renderTeam(sections.team);
  const sponsor = renderSponsor(sections.sponsor);
  const map = renderMap(sections.location);
  contentPage.innerHTML = intro + video + team + sponsor + map;
}

const serachInput = document.querySelector(".search");
const contentPage = document.querySelector(".content");

serachInput.addEventListener("keyup", displayMatches);
showList();
